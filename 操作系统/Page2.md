### 进程的概念、组成、特征

#### 进程的概念

程序：静态的，存放在磁盘里的可执行文件

进程：是动态的，是程序的一次执行过程。（同一个程序多次执行会对应多个进程）

##### Q：OS如何区分进程

A：当进程被创建时，OS会自动为每个进程分配一个进程ID，而这些进程ID是各不相同的，且每次新建进程时的PID都不相同。

#### PCB

OS要记录PID、进程所属的用户UID、还要记录分配了多少内存，正在使用哪些I/O设备……

这些信息都会被保存在一个数据结构PCB中，**即进程控制块**

PCB是进程存在的唯一标志，当进程被创建时，OS会为其创建PCB，当进程结束时，会回收其PCB。   

#### 程序段和数据段

PCB是给OS使用的，而程序段和数据段是给进程自己使用的。

##### Q：程序是如何运行的

A：程序会经过编译、链接形成的可执行性文件存放在硬盘当中，运行之前会把它放到内存当中，一个程序开始之前，需要创建其对应的进程，也就需要创建相应的PCB，程序段包含程序指令，CPU再从内存中取出指令被执行。而==数据段==包含运行过程中产生的各种数据。

一个进程实体由==PCB、程序段、数据段==组成。进程是动态的，进程实体是静态的。

#### 进程

==进程是进程实体的运行过程，是系统进行资源分配和调度的一个独立单位==

#### 进程的特征

动态性：进程是程序的一次执行过程，是动态的产生、变化和消亡的。==是进程最基本的特征==

并发性：内存中有多个进程实体，各进程可并发执行

独立性：进程是能独立运行、独立获得资源、独立接受调度的基本单位

异步性：各进程按各自独立的、不可预知的速度向前推进，OS要提供“进程同步机制”来解决异步问题

结构性：每个进程都会配置一个PCB。结构上来看，进程由程序段、数据段，PCB组成

### 进程的状态与转换

#### 进程的状态

进程正在被创建时，为==“创建态”==，会分配资源，初始化PCB

当进程创建完成之后，便进入==“就绪态”==，但是由于没有空闲CPU，就暂时不能运行

 如果一个进程此时正在CPU上运行，那么这个进程处于==运行态==

 在进程运行的过程中，可能会请求等待某个事情的发生(如等待某种系统资源的分配，或者等待其他进程的响应)在这个事件发生之前，进程无法继续往下执行，此时OS会让这个进程下CPU，并让他进入==阻塞态==

一个进程可以执行exit系统调用，请求操作系统终止该进程，此时进程会进入==终止态==，操作系统会让该进程下CPU，并回收内存空间等资源，最后还要回收该进程的PCB

运行态到阻塞态是一种进程自身作出的主动行为，而阻塞态到就绪态不是进程自身能控制的，是一种被动行为。

PS：不能由阻塞态直接转换为运行态，也不能由就绪态直接转换为阻塞态（因为进入阻塞态是进程主动请求的）

![image-20220124152213411](C:\Users\hydro\AppData\Roaming\Typora\typora-user-images\image-20220124152213411.png)

三种基本状态：

1.  运行态
2.  就绪态
3.  阻塞态

PS单个CPU的情况下，同一时刻只会有一个进程处于运行态，多核CPU情况下，可能有多个进程处于运行态。

进程PCB中，会有一个变量state来表示进程中的当前状态。对于同一状态下各个进程进行统一的管理，OS会将各个进程的PCB组织起来。

#### 进程的组织

##### 链接方式

执行指针：指向当前处于运行态的进程（单CPU计算机中，同一时刻只会有一个进程处于运行态）

就绪队列指针：……通常会把优先级高的进程放在队头

阻塞队列指针：……很多操作系统还会根据阻塞原因不同，再分为多个阻塞队列

![image-20220124153424063](C:\Users\hydro\AppData\Roaming\Typora\typora-user-images\image-20220124153424063.png)

##### 索引方式

OS会为进程建立索引表，方便管理各个不同状态的进程

![image-20220124153653116](C:\Users\hydro\AppData\Roaming\Typora\typora-user-images\image-20220124153653116.png) 

### 进程控制

