# 插值算法

比赛中，常常需要根据已知的函数点进行数据、模型的处理和分析，而有时候现有的数据很少，不足以支撑分析的进行，这时候需要使用一些数学的方法，模拟产生一些新的但又比较靠谱的值来满足需求。

## 一维插值问题

> 问题：已经有了$n+1$个节点$(x_i,y_i)(i=0,1,\cdots,n)$,其中$x_i$互不相同，假设$a=x_0<x_1<\cdots<x_n=b$，求任意插值点$x^*(x\ne x_i)$的插值$y^*$

思路：构造函数$y=f(x)$，使得$f(x)$过所有节点，求$f(x^*)$即可得到$y^*$

### 插值法原理

定理：设有$n+1$个互不相同的节点$(x_i,y_i)(i=0,1,2,\cdots,n)$，则存在唯一的多项式：
$$
L_n(x)=a_0+a_1x+a_2x^2+\cdots+a_nx^n
$$
使得$L_n(x_j)=y_j\ \ \ \ (j=0,1,2,\cdots,n)$

### 拉格朗日插值法

存在两个点：$(x_0,y_0),(x_1,y_1)$那么存在函数：
$$
f(x) = {{x-x_1}\over x_0-x_1}y_0+{{x-x_0}\over x_1-x_0}y_1
$$
存在三个点：$(x_0,y_0),(x_1,y_1),(x_2,y_2)$那么存在函数：
$$
f(x) = {{(x-x_1)(x-x_2)}\over (x_0-x_1)(x_0-x_2)}y_0
\\ \ \ \ \ \ \ \ \ +{{(x-x_0)(x-x_2)}\over (x_1-x_0)(x_1-x_2)}y_1
\\ \ \ \ \ \ \ \ \ +{{(x-x_0)(x-x_1)}\over (x_2-x_0)(x_2-x_1)}y_2
$$
综上，得出拉格朗日插值法公式为：
$$
\omega_{n+1}(x)=(x-x_0)(x-x_1)\cdots(x-x_n)\\
\omega^`_{n+1}(x_k)=(x_k-x_0)\cdots(x_k-x_{k-1})(x_k-x_{k+1})\cdots(x_k-x_n)\\
l_i(n)={{(x-x_0)\cdots(x-x_{i-1})(x-x_{i+1})\cdots(x-x_n)}\over{(x_i-x_0)\cdots(x_i-x_{i-1})(x_i-x_{i+1})\cdots(x_i-x_n)}}\\
={{(x-x_0)\cdots(x-x_{i-1})(x-x_i)(x-x_{i+1})\cdots(x-x_n)}\over{(x-x_i)(x_i-x_0)\cdots(x_i-x_{i-1})(x_i-x_{i+1})\cdots(x_i-x_n)}}\\
={{\omega_{n+1}(x)}\over(x-x_i)\omega^`_{n+1}(x_i)}
\\
L_n(x)=\sum_{k=0}^ny_k{{\omega_{n+1}(x)}\over(x-x_k)\omega^`_{n+1}(x_k)}
$$

#### 龙格现象

高次插值会产生龙格现象，即在两端处波动大，产生明显的震荡。在不熟悉曲线运动趋势的前提下，不要轻易用高次插值。为了避免产生龙格现象，可以采用分段低次插值的思路。

### 分段线性插值

分段二次插值

选取跟节点$x$最近的三个节点$x_{i-1},x_i,x_{i+1}$进行二次插值。即在每一个区间$[x_{i-1},x_{i+1}]$,取
$$
f(x)\approx L_2(x) = \sum_{k=i+1}^{i-1}[y_k \prod_{j=i-1 \ \ j\ne k}^{i+1}{{(x_i-x_j)}\over (x_k-x_i)}]
$$
这种分段的低次插值称为分段二次插值，在几何上就是用分段抛物线代替$y=f(x)$，故分段二次插值又称为**分段抛物插值**。

### 牛顿插值法

#### 差商定义

称$f[x_0,x_k]={{f(x_k)-f(x_0)}\over x_k-x_0}$为函数$f(x)$关于点$x_0,x_k$的一阶差商（亦称均差）

推导得出：

二阶差商：$f[x_0,x_1,x_2]={{f[x_0,x_2]-f[x_0,x_1]}\over x_2-x_1}$

K阶差商：$f[x_0,x_1,\dots,x_k]={{f[x_1,\dots,x_{k-1},x_k]-f[x_0,x_1,\dots,x_{k-1}]}\over x_k-x_0}$

#### 牛顿插值法公式

$$
f(x) = f(x_0)+f[x_0,x_1](x-x_0)\\+f[x_0,x_1,x_2](x-x_0)(x-x_1)+\cdots\\+f[x_0,x_1,\dots,x_{n-2},x_{n-1}](x-x_0)(x-x_1)\cdots(x-x_{n-2})(x-x_{n-1})\\+f[x_0,x_1,\dots,x_{n-1},x_n](x-x_0)(x-x_1)\cdots(x-x_{n-1})(x-x_n)
$$

#### 牛顿插值法与拉格朗日插值法对比

与拉格朗日插值法相比，牛顿插值法的计算过程具有集成性。牛顿插值法每次插值只和前n项的值有关，这样每次只要在原来的函数上添加新的项，就能够产生新的函数。但是牛顿插值法也存在着龙格现象的问题。

### 两种插值法的另一个缺点

这两种插值仅仅要求插值多项式在插值节点处与被插函数有相等的函数值，而这种插值多项式却不能全面反映被插值函数的形态。而在许多实际问题中，不仅要求插值函数与被插值函数在所有节点处有相同的函数值，他也需要在一个或者全部节点上插值多项式与被插值函数有相同的低阶甚至高阶的导数值。

### 埃尔米特插值

#### 简要原理

设函数$f(x)$在区间$[a,b]$上有$n+1$个互译节点，$a=x_0<x_1<x_2< \dots <x_n = b$，定义在$[a,b]$上函数$f(x)$在节点上满足：
$$
f(x_i)=y_i, \ \ \ \ \ \ \ f^`(x_i)=y_i^` \ \ (i=0,1,2,\dots,n) 
$$

#### 分段三次埃尔米特插值

直接使用埃尔米特插值得到的多项式次数较高，也存在着龙格现象，在实际使用之中，往往采用分段三次的埃尔米特插值多项式。

### 三次样条插值

设$y=f(x)$在点$x_0,x_1,x_2,\dots,x_n$的值为$y_0,y_1,y_2,\dots,y_n$，若函数$S(x)$满足下列条件：

1. $S(x_i)=f(x_i)=y_i,\ \ \ \ i=0,1,2,\dots,n$
2. 在每个子区间$[x_i,x_{i+1}](i=0,1,2,\dots,n-1)$上$S(x)$是三次多项式
3. $S(x)$在$[a,b]$上二阶连续可微

则称$S(x)$为函数$f(x)$的三次样条插值函数

##  n维数据的插值

```matlab
p = interpn(x1,x2,...,xn,y, new_x1,new_x2,...,new_xn, method)
% x1,x2,...,xn是已知的样本点的横坐标
% y是已知的样本点的纵坐标
% new_x1, new_x2,...,new_xn是要插入点的横坐标
% method是要插值的方法
% linear 线性插值（默认算法）
% cubic 三次插值
% spline 三次样条插值法（最为精准）
% nearest 最邻近插值算法
```

