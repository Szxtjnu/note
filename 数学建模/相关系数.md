# 相关系数

## 总体和样本

总体——所要考察的对象的全部个体叫做总体

样本——从总体中所抽取的一部分个体叫做总体的一个样本

使用样本均值、样本标准差来估计总体的均值（平均水平）和总体的标准差（偏离程度）

## 总体皮尔逊相关系数

如果两组数据$X:\{X_1,X_2,\dots,X_n\}\ \ \ Y\{Y_!,Y_2,\dots,Y_n\}$是总体数据

那么总体均值为：
$$
E(X)={{\sum_{i=1}^nX_i}\over n},E(Y)={{\sum_{i=1}^nY_i}\over n}
$$
总体协方差为：
$$
Cov(X,Y)={{\sum_{i=1}^n(X_i-E(X))(Y_i-E(Y))}\over n}
$$
协方差的大小和两个变量的量纲有关，不适合作比较。

### 总体皮尔逊相关系数：

$$
\rho_{XY}={Cov(X,Y)\over \sigma_X\sigma_Y}={{\sum_{i=1}^n{(X_i-E(X))\over \sigma_X}{(Y_i-E(Y))\over \sigma_Y}}\over n}\\
\sigma_X = \sqrt{{\sum_{i=1}^n}(X_i-E(X))^2 \over n}\\
\sigma_Y = \sqrt{{\sum_{i=1}^n}(Y_i-E(Y))^2 \over n}\\
|\rho_{XY}|\le 1\\
当Y=aX+b时,\rho_{XY}=\begin{cases} 1 ,&a>0 \\-1,&a<0 \end{cases}
$$

皮尔逊相关系数可以看成是剔除了两个变量量纲影响，即将X和Y标准化后的协方差

### 样本皮尔逊相关系数

$$
Cov(X,Y)={{\sum_{i=1}^n{(X_i-\bar X)}{(Y_i- \bar Y)}}\over n-1}\\
S_X = \sqrt{{\sum_{i=1}^n}(X_i-\bar X)^2 \over n-1}\\
S_Y = \sqrt{{\sum_{i=1}^n}(Y_i-\bar Y)^2 \over n-1}\\
\gamma _{XY}={{Cov(X,Y)}\over S_XS_Y}
$$

### 关于皮尔逊相关系数的说明

皮尔逊相关系数只能用来衡量两个变量线性相关程度。也就是说，只有先确认这两个变量是线性相关的，才能使用皮尔逊系数来测量线性程度如何。

1. 非线性相关也会导致线性相关系数很大
2. 离群点对相关系数的影响很大
3. 如果两个变量的相关系数很大也不能说明两者相关，可能会受到异常值的影响
4. 相关系数的计算结果为0，只能说是不是线性相关，但说不定会有更复杂的相关关系

### 对于相关系数大小的解释

<img src="D:\typora-pic\相关系数\image-20220717161035026.png" alt="image-20220717161035026" style="zoom:50%;" />

上表所定的标准从某种意义上来说是武断和不严格的，对于相关系数的解释是依赖于具体的应用背景和目的的。**事实上，比起相关系数的大小，往往更关注的是显著性（假设检验）**

## 对于相关系数进行假设检验

1. 提出原假设$H_0$和备择假设$H_1$，假设我们计算出了一个皮尔逊相关系数$r$，我们想检验它是否显著的异于0，那么我们可以这样设定原假设和备择假设：$H_0:r=0\ \ ,\ \ H_1:r\ne 0$

2. 在原假设成立的条件下，利用我们要检测的量构造出一个符合某一分布的统计量。对于皮尔逊相关系数而言，在满足一定的条件下，我们可以构造统计量：
	$$
	t = r\sqrt{{n-2}\over 1-r^2}
	$$
	可以证明$t$是服从自由度为$n-2$的$t$分布

3. 将我们要检验的这个值带入这个统计量之中，可以得到一个特定的值（检验值）。

4. 由于我们知道统计量的分布情况，因此我们可以画出该分布的概率密度函数$pdf$，并给定一个置信水平，根据这个置信水平查表找到临界值，画出检验统计量的接受域和拒绝域。

5. 看计算出来的检验值是落在了拒绝域还是接受域，并下结论。

也可以只用p值判断法来进行判断：根据得到的检验值，计算出对应的概率

## 皮尔逊相关系数假设检验条件

第一，实验数据通常假设是成对的来自于正态分布的总体。

第二，实验数据之间的差距不能太大。

第三，每组样本之间是独立抽样的。

### 正态分布JB检验

雅克贝拉检验，要求样本数据量n>30

对于一个随机变量$\{X_i\}$，假设其偏度为$S$，峰度为$K$，那么我们可以构造$JB$统计量：
$$
JB={n\over 6}[S^2+{{(K-3)^2}\over4}]
$$
可以证明，如果$\{X_i\}$是正态分布，那么在大样本的情况下$JB \sim\chi^2(2)$

其中，偏度为$E[({X-u\over \sigma})^3]$，峰度为$E[({X-u\over \sigma})^4]$