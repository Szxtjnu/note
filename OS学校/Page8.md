#### 进程互斥

进程的并发执行是资源有限性导致资源的竞争与共享对进程的执行过程进行制约所造成的。

##### 临界区

为了保证程序执行最终结果的正确性，必须对并发执行的各进程进行制约，以控制他们的执行速度和对资源的竞争。

把不允许多个并发进程交叉执行的一段程序成为临街部分或临界区

临界区是由属于不同并发进程的程序段共享公用数据或公用数据变量而引起的。

临界区不可能用增加硬件的方式来解决

临界区也可以被称为访问公用数据的程序段

##### 间接制约

由于共享某一共有资源而引起的临界区内不允许并发进程交叉执行的现象，称为由共享公有资源而造成的对并发进程执行速度的间接制约，简称为间接制约。这里的间接二字主要指各并发进程的速度受公有资源制约。

对于每一类，系统应有相应的分配和释放相应公有资源的管理办法，以制约并发进程。这就是互斥

#### 互斥

定义为一组并发进程中的一个或者多个程序段，因共享某一公有资源而导致他们必须以一个不允许交叉执行的单位执行。也就是说，不允许两个以上的共享该资源的并发进程同时进入临界区成为互斥。

一组并发进程互斥执行时，满足的准则

1. 不能假设各并发进程的相对执行速度，即各并发进程之间享有平等、独立的竞争公有资源的权利，且在不采取任何措施的条件下，在临界区内任意指令结束时，其他并发进程可以进入临界区
2. 并发进程中的某个进程不在临界区时，它不阻止其他进程进入临界区
3. 并发进程中的若干个进程申请进入临界区时，只能允许一个进程进入
4. 并发进程中的某个进程申请进入临界区时开始，应在有限的时间内得以进入临界区

这里准则1,2,3是保证各并发进程享有平等的、独立的竞争和使用公有资源的权利，且保证每个时刻至多只有一个进程在临界区。

而准则4是并发进程不发生死锁的重要保证，否则，由于某个并发进程长期占有临界区，其他进程则因为不能进入临界而进入互相等待的状态。

##### 互斥的加锁实现

当某个进程进入临界区之后，它将锁上临界区，直到它退出临界区为止，并发进程在申请进入临界区时，首先测试该临界区是否是上锁的，如果该临界区已经被锁住，则该进程要等到该临界区开锁之后，才有可能获得临界区。

#### 信号量和P，V原语

##### 信号量

在使用加锁法解决进程互斥问题时，一个进程能否进入临界区是依靠进程自己调用lock过程去测试相应的锁定位。每个进程能否进入临界区是依靠自己的测试判断。这样就会出现不公平现象。

信号量管理响应临界区的公有资源，他代表可用资源实体。

##### P V原语

信号量的数值仅能由PV原语操作改变。PV分别是pass和increment的意思。

一次P原语操作使得信号量SEM减1，而一次V原语将使得信号量SEM加1.

当某个进程在临界区执行时，其他进程如果执行了P原语，则该进程并不像调用lock时那样因进不了临界区而返回到lock 的起点，而是在等待队列中等待其他进程做V原语操作释放资源后，进入临界区，这时，P原语的执行才算真正结束

​                                                                                    